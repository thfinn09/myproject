<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Note App</title>
</head>
<body>

  <h2>NOTE APP</h2>

  <input id="id" placeholder="ID (tự nhập)" /><br><br>
  <input id="title" placeholder="Title" /><br><br>
  <textarea id="content" placeholder="Content"></textarea><br><br>

  <button onclick="createNote()">Create</button>
  <button onclick="updateNote()">Update</button>
  <button onclick="deleteNote()">Delete</button>
  <button onclick="loadNotes()">Reload</button>

  <hr>

  <ul id="notes"></ul>

  <script>
    const API = "http://localhost:3000/api/notes";

    async function loadNotes() {
      const res = await fetch(API);
      const data = await res.json();

      const ul = document.getElementById("notes");
      ul.innerHTML = "";

      data.forEach(note => {
        const li = document.createElement("li");
        li.innerText = `${note.id} | ${note.title}`;
        li.onclick = () => fillForm(note);
        ul.appendChild(li);
      });
    }

    function fillForm(note) {
      id.value = note.id;
      title.value = note.title;
      content.value = note.content || "";
    }

    async function createNote() {
      await fetch(API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          id: id.value,
          title: title.value,
          content: content.value
        })
      });
      loadNotes();
    }

    async function updateNote() {
      await fetch(`${API}/${id.value}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          title: title.value,
          content: content.value
        })
      });
      loadNotes();
    }

    async function deleteNote() {
      await fetch(`${API}/${id.value}`, {
        method: "DELETE"
      });
      loadNotes();
    }

    loadNotes();
  </script>

</body>
</html>
